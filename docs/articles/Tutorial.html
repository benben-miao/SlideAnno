<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>SeuratVisPro Tutorial • GAnnoViz</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="SeuratVisPro Tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GAnnoViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-passport"></span> Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-code"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Tutorial.html"><span class="fa fa-file-code"></span> Tutorial</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/benben-miao/GAnnoViz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="Tutorial_files/kePrint-0.0.1/kePrint.js"></script><link href="Tutorial_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SeuratVisPro Tutorial</h1>
                        <h4 data-toc-skip class="author">benben-miao</h4>
            
            <h4 data-toc-skip class="date">2025-12-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/benben-miao/GAnnoViz/blob/HEAD/vignettes/Tutorial.Rmd"><code>vignettes/Tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>Tutorial.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="gannoviz">GAnnoViz<a class="anchor" aria-label="anchor" href="#gannoviz"></a>
</h2>
<div class="section level3">
<h3 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p><strong>SourceCode:</strong> <a href="https://github.com/benben-miao/GAnnoViz/" class="uri">https://github.com/benben-miao/GAnnoViz/</a></p>
<p><strong>Website API</strong>: <a href="https://benben-miao.github.io/GAnnoViz/" class="external-link uri">https://benben-miao.github.io/GAnnoViz/</a></p>
<p>GAnnoViz: a R package for genomic annotation and visualization.</p>
<div class="section level4">
<h4 id="key-features">Key features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h4>
<ul>
<li>Comprehensive GFF/GTF parsing into tidy GRanges workflows</li>
<li>Publication-grade genomic visualizations: gene structure, interval
structure, and chromosome layouts</li>
<li>Signal overlays for population and epigenetic analyses (FST, DMR)
with robust window aggregation</li>
<li>Innovative genome-wide density maps and circos-style rings for
exploratory analysis</li>
<li>Modular API with consistent theming for reproducible, high-quality
figures</li>
</ul>
</div>
<div class="section level4">
<h4 id="typical-inputs">Typical inputs<a class="anchor" aria-label="anchor" href="#typical-inputs"></a>
</h4>
<ul>
<li>Structural annotations: GFF3/GTF</li>
<li>Population genetics: sliding-window FST tables</li>
<li>Epigenetics: methylKit-derived DMR tables</li>
<li>Differential expression: DESeq2-style DEG tables</li>
</ul>
</div>
<div class="section level4">
<h4 id="design-principles">Design principles<a class="anchor" aria-label="anchor" href="#design-principles"></a>
</h4>
<ul>
<li>Consistent chromosome ordering and coordinate handling across
functions</li>
<li>Overlap-length weighted aggregation for window-based statistics</li>
<li>Publication-ready defaults, minimal external dependencies,
reproducible outputs</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="installation">2. Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
</div>
<div class="section level3">
<h3 id="shiny-app">3. Shiny App<a class="anchor" aria-label="anchor" href="#shiny-app"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GAnnoVizApp()</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extract-features">4. Extract Features<a class="anchor" aria-label="anchor" href="#extract-features"></a>
</h3>
<div class="section level4">
<h4 id="extract-genes">Extract Genes<a class="anchor" aria-label="anchor" href="#extract-genes"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example GFF3 file in GAnnoViz</span></span>
<span><span class="va">gff_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>,</span>
<span>  <span class="st">"example.gff"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"GAnnoViz"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract Genes</span></span>
<span><span class="co"># genes &lt;- extract_genes(</span></span>
<span><span class="co">#   gff_file = gff_file,</span></span>
<span><span class="co">#   format = "auto",</span></span>
<span><span class="co">#   gene_info = "all")</span></span>
<span><span class="co"># genes</span></span>
<span></span>
<span><span class="co"># Gene info: gene_range</span></span>
<span><span class="va">gene_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_genes.html">extract_genes</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  gene_info <span class="op">=</span> <span class="st">"gene_range"</span><span class="op">)</span></span>
<span><span class="co"># head(gene_range)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_range</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. Gene range results"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. Gene range results
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
start
</th>
<th style="text-align:center;font-weight: bold;">
end
</th>
<th style="text-align:center;font-weight: bold;">
width
</th>
<th style="text-align:center;font-weight: bold;">
names
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
10724003
</td>
<td style="text-align:center;line-height: 2em;">
10725460
</td>
<td style="text-align:center;line-height: 2em;">
1458
</td>
<td style="text-align:center;line-height: 2em;">
HdF000001
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
10808174
</td>
<td style="text-align:center;line-height: 2em;">
10823308
</td>
<td style="text-align:center;line-height: 2em;">
15135
</td>
<td style="text-align:center;line-height: 2em;">
HdF000002
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
10911391
</td>
<td style="text-align:center;line-height: 2em;">
10930352
</td>
<td style="text-align:center;line-height: 2em;">
18962
</td>
<td style="text-align:center;line-height: 2em;">
HdF000003
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
10939872
</td>
<td style="text-align:center;line-height: 2em;">
10941326
</td>
<td style="text-align:center;line-height: 2em;">
1455
</td>
<td style="text-align:center;line-height: 2em;">
HdF000004
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
10982117
</td>
<td style="text-align:center;line-height: 2em;">
10999259
</td>
<td style="text-align:center;line-height: 2em;">
17143
</td>
<td style="text-align:center;line-height: 2em;">
HdF000005
</td>
</tr>
<tr>
<td style="text-align:center;">
11012358
</td>
<td style="text-align:center;">
11024009
</td>
<td style="text-align:center;">
11652
</td>
<td style="text-align:center;">
HdF000006
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="extract-cds">Extract CDS<a class="anchor" aria-label="anchor" href="#extract-cds"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract CDS</span></span>
<span><span class="co"># cds &lt;- extract_cds(</span></span>
<span><span class="co">#   gff_file = gff_file,</span></span>
<span><span class="co">#   format = "auto",</span></span>
<span><span class="co">#   cds_info = "all")</span></span>
<span><span class="co"># cds</span></span>
<span></span>
<span><span class="co"># CDS info: cds_range</span></span>
<span><span class="va">cds_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_cds.html">extract_cds</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  cds_info <span class="op">=</span> <span class="st">"cds_range"</span><span class="op">)</span></span>
<span><span class="co"># head(cds_range)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cds_range</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. CDS range results"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. CDS range results
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
start
</th>
<th style="text-align:center;font-weight: bold;">
end
</th>
<th style="text-align:center;font-weight: bold;">
width
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
810081
</td>
<td style="text-align:center;line-height: 2em;">
810090
</td>
<td style="text-align:center;line-height: 2em;">
10
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
816466
</td>
<td style="text-align:center;line-height: 2em;">
816734
</td>
<td style="text-align:center;line-height: 2em;">
269
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
818765
</td>
<td style="text-align:center;line-height: 2em;">
818971
</td>
<td style="text-align:center;line-height: 2em;">
207
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
819680
</td>
<td style="text-align:center;line-height: 2em;">
819740
</td>
<td style="text-align:center;line-height: 2em;">
61
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
821042
</td>
<td style="text-align:center;line-height: 2em;">
821214
</td>
<td style="text-align:center;line-height: 2em;">
173
</td>
</tr>
<tr>
<td style="text-align:center;">
825267
</td>
<td style="text-align:center;">
825329
</td>
<td style="text-align:center;">
63
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="extract-promoters">Extract Promoters<a class="anchor" aria-label="anchor" href="#extract-promoters"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract Promoters</span></span>
<span><span class="co"># promoters &lt;- extract_promoters(</span></span>
<span><span class="co">#   gff_file = gff_file,</span></span>
<span><span class="co">#   format = "auto",</span></span>
<span><span class="co">#   upstream = 2000,</span></span>
<span><span class="co">#   downstream = 200,</span></span>
<span><span class="co">#   promoter_info = "all")</span></span>
<span><span class="co"># promoters</span></span>
<span></span>
<span><span class="co"># Promoter info: promoter_range</span></span>
<span><span class="va">promoter_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_promoters.html">extract_promoters</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  upstream <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  downstream <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  promoter_info <span class="op">=</span> <span class="st">"promoter_range"</span><span class="op">)</span></span>
<span><span class="co"># head(promoter_range)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">promoter_range</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. Promoter range results"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. Promoter range results
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
start
</th>
<th style="text-align:center;font-weight: bold;">
end
</th>
<th style="text-align:center;font-weight: bold;">
width
</th>
<th style="text-align:center;font-weight: bold;">
names
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
807987
</td>
<td style="text-align:center;line-height: 2em;">
810186
</td>
<td style="text-align:center;line-height: 2em;">
2200
</td>
<td style="text-align:center;line-height: 2em;">
nbis-mrna-126
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
882426
</td>
<td style="text-align:center;line-height: 2em;">
884625
</td>
<td style="text-align:center;line-height: 2em;">
2200
</td>
<td style="text-align:center;line-height: 2em;">
nbis-mrna-127
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
949197
</td>
<td style="text-align:center;line-height: 2em;">
951396
</td>
<td style="text-align:center;line-height: 2em;">
2200
</td>
<td style="text-align:center;line-height: 2em;">
nbis-mrna-129
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
1058746
</td>
<td style="text-align:center;line-height: 2em;">
1060945
</td>
<td style="text-align:center;line-height: 2em;">
2200
</td>
<td style="text-align:center;line-height: 2em;">
nbis-mrna-130
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
1184302
</td>
<td style="text-align:center;line-height: 2em;">
1186501
</td>
<td style="text-align:center;line-height: 2em;">
2200
</td>
<td style="text-align:center;line-height: 2em;">
nbis-mrna-132
</td>
</tr>
<tr>
<td style="text-align:center;">
1259096
</td>
<td style="text-align:center;">
1261295
</td>
<td style="text-align:center;">
2200
</td>
<td style="text-align:center;">
nbis-mrna-134
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="extract-5utr">Extract 5’UTR<a class="anchor" aria-label="anchor" href="#extract-5utr"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract 5'UTR</span></span>
<span><span class="co"># utr5 &lt;- extract_utr5(</span></span>
<span><span class="co">#   gff_file = gff_file,</span></span>
<span><span class="co">#   format = "auto",</span></span>
<span><span class="co">#   utr5_info = "all")</span></span>
<span><span class="co"># utr5</span></span>
<span></span>
<span><span class="co"># 5'UTR info: utr5_range</span></span>
<span><span class="va">utr5_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_utr5.html">extract_utr5</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  utr5_info <span class="op">=</span> <span class="st">"utr5_range"</span><span class="op">)</span></span>
<span><span class="co"># head(utr5_range)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">utr5_range</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. 5'UTR range results"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. 5’UTR range results
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
start
</th>
<th style="text-align:center;font-weight: bold;">
end
</th>
<th style="text-align:center;font-weight: bold;">
width
</th>
<th style="text-align:center;font-weight: bold;">
names
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
809987
</td>
<td style="text-align:center;line-height: 2em;">
810080
</td>
<td style="text-align:center;line-height: 2em;">
94
</td>
<td style="text-align:center;line-height: 2em;">
1
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
884426
</td>
<td style="text-align:center;line-height: 2em;">
884645
</td>
<td style="text-align:center;line-height: 2em;">
220
</td>
<td style="text-align:center;line-height: 2em;">
2
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
951197
</td>
<td style="text-align:center;line-height: 2em;">
951558
</td>
<td style="text-align:center;line-height: 2em;">
362
</td>
<td style="text-align:center;line-height: 2em;">
3
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
952741
</td>
<td style="text-align:center;line-height: 2em;">
952756
</td>
<td style="text-align:center;line-height: 2em;">
16
</td>
<td style="text-align:center;line-height: 2em;">
3
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
1060746
</td>
<td style="text-align:center;line-height: 2em;">
1060848
</td>
<td style="text-align:center;line-height: 2em;">
103
</td>
<td style="text-align:center;line-height: 2em;">
4
</td>
</tr>
<tr>
<td style="text-align:center;">
1261096
</td>
<td style="text-align:center;">
1261128
</td>
<td style="text-align:center;">
33
</td>
<td style="text-align:center;">
6
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="plot-structure">5. Plot Structure<a class="anchor" aria-label="anchor" href="#plot-structure"></a>
</h3>
<div class="section level4">
<h4 id="plot-gene-stats-for-chromosomes">Plot gene stats for chromosomes<a class="anchor" aria-label="anchor" href="#plot-gene-stats-for-chromosomes"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot gene stats</span></span>
<span><span class="fu"><a href="../reference/plot_gene_stats.html">plot_gene_stats</a></span><span class="op">(</span></span>
<span>    gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>    format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>    bar_width <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>    bar_color <span class="op">=</span> <span class="st">"#0055ff55"</span>,</span>
<span>    lable_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_gene_stats-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-gene-structure-promoter-3utr-exon-intron-5utr">Plot gene structure (Promoter, 3’UTR, Exon, Intron, 5’UTR)<a class="anchor" aria-label="anchor" href="#plot-gene-structure-promoter-3utr-exon-intron-5utr"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot gene structure</span></span>
<span><span class="fu"><a href="../reference/plot_gene_structure.html">plot_gene_structure</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  gene_id <span class="op">=</span> <span class="st">"HdF029609"</span>,</span>
<span>  upstream <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  downstream <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  feature_alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  intron_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  x_breaks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  arrow_length <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  arrow_count <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arrow_unit <span class="op">=</span> <span class="st">"pt"</span>,</span>
<span>  promoter_color <span class="op">=</span> <span class="st">"#ff8800"</span>,</span>
<span>  utr5_color <span class="op">=</span> <span class="st">"#008833"</span>,</span>
<span>  utr3_color <span class="op">=</span> <span class="st">"#ff0033"</span>,</span>
<span>  exon_color <span class="op">=</span> <span class="st">"#0033ff"</span>,</span>
<span>  intron_color <span class="op">=</span> <span class="st">"#333333"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_gene_structure-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-gene-structures-for-a-genomic-interval">Plot gene structures for a genomic interval<a class="anchor" aria-label="anchor" href="#plot-gene-structures-for-a-genomic-interval"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot interval structure</span></span>
<span><span class="fu"><a href="../reference/plot_interval_structure.html">plot_interval_structure</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  chrom_id <span class="op">=</span> <span class="st">"chr1"</span>,</span>
<span>  start <span class="op">=</span> <span class="fl">950000</span>,</span>
<span>  end <span class="op">=</span> <span class="fl">1180000</span>,</span>
<span>  x_breaks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  upstream <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  downstream <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  feature_alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  intron_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arrow_count <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arrow_length <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  arrow_unit <span class="op">=</span> <span class="st">"pt"</span>,</span>
<span>  promoter_color <span class="op">=</span> <span class="st">"#ff8800"</span>,</span>
<span>  utr5_color <span class="op">=</span> <span class="st">"#008833"</span>,</span>
<span>  utr3_color <span class="op">=</span> <span class="st">"#ff0033"</span>,</span>
<span>  exon_color <span class="op">=</span> <span class="st">"#0033ff"</span>,</span>
<span>  intron_color <span class="op">=</span> <span class="st">"#333333"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_interval_structure-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-interval-flank-structure-around-a-focal-gene">Plot interval flank structure around a focal gene<a class="anchor" aria-label="anchor" href="#plot-interval-flank-structure-around-a-focal-gene"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Neighborhood around a focal gene on its chromosome</span></span>
<span><span class="fu"><a href="../reference/plot_interval_flank.html">plot_interval_flank</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  gene_id <span class="op">=</span> <span class="st">"HdF029609"</span>,</span>
<span>  flank_upstream <span class="op">=</span> <span class="fl">200000</span>,</span>
<span>  flank_downstream <span class="op">=</span> <span class="fl">200000</span>,</span>
<span>  show_promoters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  upstream <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  downstream <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  arrow_length <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  arrow_unit <span class="op">=</span> <span class="st">"pt"</span>,</span>
<span>  gene_color <span class="op">=</span> <span class="st">"#0088ff"</span>,</span>
<span>  promoter_color <span class="op">=</span> <span class="st">"#ff8800"</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_interval_flank-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-chromosome-structures-and-gene-stats">Plot chromosome structures and gene stats<a class="anchor" aria-label="anchor" href="#plot-chromosome-structures-and-gene-stats"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot chrom structure</span></span>
<span><span class="fu"><a href="../reference/plot_chrom_structure.html">plot_chrom_structure</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  orientation <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>  bar_width <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  chrom_alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  gene_width <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  chrom_color <span class="op">=</span> <span class="st">"#008888"</span>,</span>
<span>  gene_color <span class="op">=</span> <span class="st">"#0088ff"</span>,</span>
<span>  telomere_color <span class="op">=</span> <span class="st">"#ff0000"</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_chrom_structure-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-chromosome-structures-and-gene-annotation">Plot chromosome structures and gene annotation<a class="anchor" aria-label="anchor" href="#plot-chromosome-structures-and-gene-annotation"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  gene_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HdF029609"</span>, <span class="st">"HdF029610"</span><span class="op">)</span>,</span>
<span>  gene_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vertical, annotate by name</span></span>
<span><span class="fu"><a href="../reference/plot_chrom_genes.html">plot_chrom_genes</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  gene_table <span class="op">=</span> <span class="va">genes</span>,</span>
<span>  annotate <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  orientation <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_chrom_genes-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="deg-anno-viz">6. DEG Anno &amp; Viz<a class="anchor" aria-label="anchor" href="#deg-anno-viz"></a>
</h3>
<div class="section level4">
<h4 id="annotate-differentially-expressed-genes-degs-with-chromosome-positions">Annotate differentially expressed genes (DEGs) with chromosome
positions<a class="anchor" aria-label="anchor" href="#annotate-differentially-expressed-genes-degs-with-chromosome-positions"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example DEGs GAnnoViz</span></span>
<span><span class="va">deg_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>,</span>
<span>  <span class="st">"example.deg"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"GAnnoViz"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">deg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">deg_file</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>  na.strings <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># head(deg)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">deg</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. DEGs results from DESeq2"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. DEGs results from DESeq2
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
GeneID
</th>
<th style="text-align:center;font-weight: bold;">
baseMean
</th>
<th style="text-align:center;font-weight: bold;">
log2FoldChange
</th>
<th style="text-align:center;font-weight: bold;">
lfcSE
</th>
<th style="text-align:center;font-weight: bold;">
stat
</th>
<th style="text-align:center;font-weight: bold;">
pvalue
</th>
<th style="text-align:center;font-weight: bold;">
padj
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
HdF054777
</td>
<td style="text-align:center;line-height: 2em;">
16.999581
</td>
<td style="text-align:center;line-height: 2em;">
-1.480620
</td>
<td style="text-align:center;line-height: 2em;">
0.7189789
</td>
<td style="text-align:center;line-height: 2em;">
-2.059337
</td>
<td style="text-align:center;line-height: 2em;">
0.0394619
</td>
<td style="text-align:center;line-height: 2em;">
0.5479174
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
HdF055254
</td>
<td style="text-align:center;line-height: 2em;">
10.012632
</td>
<td style="text-align:center;line-height: 2em;">
3.039624
</td>
<td style="text-align:center;line-height: 2em;">
1.3467639
</td>
<td style="text-align:center;line-height: 2em;">
2.256984
</td>
<td style="text-align:center;line-height: 2em;">
0.0240091
</td>
<td style="text-align:center;line-height: 2em;">
0.4341369
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
HdF055463
</td>
<td style="text-align:center;line-height: 2em;">
3.926022
</td>
<td style="text-align:center;line-height: 2em;">
5.319215
</td>
<td style="text-align:center;line-height: 2em;">
2.2806921
</td>
<td style="text-align:center;line-height: 2em;">
2.332281
</td>
<td style="text-align:center;line-height: 2em;">
0.0196859
</td>
<td style="text-align:center;line-height: 2em;">
NA
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
HdF027237
</td>
<td style="text-align:center;line-height: 2em;">
1433.976916
</td>
<td style="text-align:center;line-height: 2em;">
-1.802171
</td>
<td style="text-align:center;line-height: 2em;">
0.3336465
</td>
<td style="text-align:center;line-height: 2em;">
-5.401438
</td>
<td style="text-align:center;line-height: 2em;">
0.0000001
</td>
<td style="text-align:center;line-height: 2em;">
0.0000283
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
HdF027261
</td>
<td style="text-align:center;line-height: 2em;">
178.124271
</td>
<td style="text-align:center;line-height: 2em;">
-1.049145
</td>
<td style="text-align:center;line-height: 2em;">
0.4681808
</td>
<td style="text-align:center;line-height: 2em;">
-2.240897
</td>
<td style="text-align:center;line-height: 2em;">
0.0250327
</td>
<td style="text-align:center;line-height: 2em;">
0.4406169
</td>
</tr>
<tr>
<td style="text-align:center;">
HdF002748
</td>
<td style="text-align:center;">
185.015989
</td>
<td style="text-align:center;">
2.051539
</td>
<td style="text-align:center;">
0.9494449
</td>
<td style="text-align:center;">
2.160778
</td>
<td style="text-align:center;">
0.0307125
</td>
<td style="text-align:center;">
0.4865774
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Annotate DEGs with chromosome positions</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anno_deg_chrom.html">anno_deg_chrom</a></span><span class="op">(</span></span>
<span>  deg_file <span class="op">=</span> <span class="va">deg_file</span>,</span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  id_col <span class="op">=</span> <span class="st">"GeneID"</span>,</span>
<span>  fc_col <span class="op">=</span> <span class="st">"log2FoldChange"</span>,</span>
<span>  use_strand <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_unmapped <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># head(res)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. DEGs annotation results"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. DEGs annotation results
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
chrom
</th>
<th style="text-align:center;font-weight: bold;">
start
</th>
<th style="text-align:center;font-weight: bold;">
end
</th>
<th style="text-align:center;font-weight: bold;">
gene_id
</th>
<th style="text-align:center;font-weight: bold;">
score
</th>
<th style="text-align:center;font-weight: bold;">
strand
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
chr14
</td>
<td style="text-align:center;line-height: 2em;">
12802589
</td>
<td style="text-align:center;line-height: 2em;">
12807112
</td>
<td style="text-align:center;line-height: 2em;">
HdF000031
</td>
<td style="text-align:center;line-height: 2em;">
1.408356
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr14
</td>
<td style="text-align:center;line-height: 2em;">
12979855
</td>
<td style="text-align:center;line-height: 2em;">
12984114
</td>
<td style="text-align:center;line-height: 2em;">
HdF000041
</td>
<td style="text-align:center;line-height: 2em;">
-1.114777
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr14
</td>
<td style="text-align:center;line-height: 2em;">
13092225
</td>
<td style="text-align:center;line-height: 2em;">
13094734
</td>
<td style="text-align:center;line-height: 2em;">
HdF000049
</td>
<td style="text-align:center;line-height: 2em;">
1.271638
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr14
</td>
<td style="text-align:center;line-height: 2em;">
13915421
</td>
<td style="text-align:center;line-height: 2em;">
13919063
</td>
<td style="text-align:center;line-height: 2em;">
HdF000066
</td>
<td style="text-align:center;line-height: 2em;">
-6.180426
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr14
</td>
<td style="text-align:center;line-height: 2em;">
15038730
</td>
<td style="text-align:center;line-height: 2em;">
15050966
</td>
<td style="text-align:center;line-height: 2em;">
HdF000091
</td>
<td style="text-align:center;line-height: 2em;">
-1.250090
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
</tr>
<tr>
<td style="text-align:center;">
chr14
</td>
<td style="text-align:center;">
15455652
</td>
<td style="text-align:center;">
15456778
</td>
<td style="text-align:center;">
HdF000106
</td>
<td style="text-align:center;">
-6.085891
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="plot-genomic-feature-density-heatmap">Plot genomic feature density heatmap<a class="anchor" aria-label="anchor" href="#plot-genomic-feature-density-heatmap"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gene density heatmap</span></span>
<span><span class="fu"><a href="../reference/plot_chrom_heatmap.html">plot_chrom_heatmap</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  feature <span class="op">=</span> <span class="st">"gene"</span>,</span>
<span>  bin_size <span class="op">=</span> <span class="fl">1e6</span>,</span>
<span>  orientation <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffffff"</span>, <span class="st">"#0055aa"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_chrom_heatmap-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-differentially-expressed-genes-degs-hyperhypo-distributions-by-chromosome">Plot differentially expressed genes (DEGs) hyper/hypo distributions
by chromosome<a class="anchor" aria-label="anchor" href="#plot-differentially-expressed-genes-degs-hyperhypo-distributions-by-chromosome"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot chrom DEGs</span></span>
<span><span class="fu"><a href="../reference/plot_chrom_deg.html">plot_chrom_deg</a></span><span class="op">(</span></span>
<span>  deg_file <span class="op">=</span> <span class="va">deg_file</span>,</span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  id_col <span class="op">=</span> <span class="st">"GeneID"</span>,</span>
<span>  fc_col <span class="op">=</span> <span class="st">"log2FoldChange"</span>,</span>
<span>  violin_scale <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>  violin_border <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  point_shape <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  jitter_width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  hyper_color <span class="op">=</span> <span class="st">"#ff000088"</span>,</span>
<span>  hypo_color <span class="op">=</span> <span class="st">"#00880088"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_chrom_deg-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="snp-anno-plot">7. SNP Anno &amp; Plot<a class="anchor" aria-label="anchor" href="#snp-anno-plot"></a>
</h3>
<div class="section level4">
<h4 id="annotate-fst-slide-windows-with-genomic-features">Annotate FST slide windows with genomic features<a class="anchor" aria-label="anchor" href="#annotate-fst-slide-windows-with-genomic-features"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Annotate FST</span></span>
<span><span class="va">fst_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="st">"example.fst"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"GAnnoViz"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">fst_table</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>  na.strings <span class="op">=</span> <span class="st">"NA"</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># head(fst)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fst</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. FST results from VCFtools"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. FST results from VCFtools
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
CHROM
</th>
<th style="text-align:center;font-weight: bold;">
BIN_START
</th>
<th style="text-align:center;font-weight: bold;">
BIN_END
</th>
<th style="text-align:center;font-weight: bold;">
N_VARIANTS
</th>
<th style="text-align:center;font-weight: bold;">
WEIGHTED_FST
</th>
<th style="text-align:center;font-weight: bold;">
MEAN_FST
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
10001
</td>
<td style="text-align:center;line-height: 2em;">
20000
</td>
<td style="text-align:center;line-height: 2em;">
7
</td>
<td style="text-align:center;line-height: 2em;">
0.0436644
</td>
<td style="text-align:center;line-height: 2em;">
0.0239114
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
15001
</td>
<td style="text-align:center;line-height: 2em;">
25000
</td>
<td style="text-align:center;line-height: 2em;">
7
</td>
<td style="text-align:center;line-height: 2em;">
0.0436644
</td>
<td style="text-align:center;line-height: 2em;">
0.0239114
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
25001
</td>
<td style="text-align:center;line-height: 2em;">
35000
</td>
<td style="text-align:center;line-height: 2em;">
4
</td>
<td style="text-align:center;line-height: 2em;">
0.0150391
</td>
<td style="text-align:center;line-height: 2em;">
0.0161973
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
30001
</td>
<td style="text-align:center;line-height: 2em;">
40000
</td>
<td style="text-align:center;line-height: 2em;">
4
</td>
<td style="text-align:center;line-height: 2em;">
0.0150391
</td>
<td style="text-align:center;line-height: 2em;">
0.0161973
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
55001
</td>
<td style="text-align:center;line-height: 2em;">
65000
</td>
<td style="text-align:center;line-height: 2em;">
1
</td>
<td style="text-align:center;line-height: 2em;">
-0.0044487
</td>
<td style="text-align:center;line-height: 2em;">
-0.0044487
</td>
</tr>
<tr>
<td style="text-align:center;">
chr11
</td>
<td style="text-align:center;">
60001
</td>
<td style="text-align:center;">
70000
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
-0.0044487
</td>
<td style="text-align:center;">
-0.0044487
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anno_fst_dmr.html">anno_fst_dmr</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  genomic_ranges <span class="op">=</span> <span class="va">fst_table</span>,</span>
<span>  chrom_col <span class="op">=</span> <span class="st">"CHROM"</span>,</span>
<span>  start_col <span class="op">=</span> <span class="st">"BIN_START"</span>,</span>
<span>  end_col <span class="op">=</span> <span class="st">"BIN_END"</span>,</span>
<span>  upstream <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  downstream <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  ignore_strand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"promoter"</span>, <span class="st">"UTR5"</span>, <span class="st">"gene"</span>, <span class="st">"exon"</span>, <span class="st">"intron"</span>, <span class="st">"CDS"</span>, <span class="st">"UTR3"</span>, <span class="st">"intergenic"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># head(res)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. FST annotation results"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. FST annotation results
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
CHROM
</th>
<th style="text-align:center;font-weight: bold;">
BIN_START
</th>
<th style="text-align:center;font-weight: bold;">
BIN_END
</th>
<th style="text-align:center;font-weight: bold;">
N_VARIANTS
</th>
<th style="text-align:center;font-weight: bold;">
WEIGHTED_FST
</th>
<th style="text-align:center;font-weight: bold;">
MEAN_FST
</th>
<th style="text-align:center;font-weight: bold;">
anno_type
</th>
<th style="text-align:center;font-weight: bold;">
gene_id
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
10001
</td>
<td style="text-align:center;line-height: 2em;">
20000
</td>
<td style="text-align:center;line-height: 2em;">
7
</td>
<td style="text-align:center;line-height: 2em;">
0.0436644
</td>
<td style="text-align:center;line-height: 2em;">
0.0239114
</td>
<td style="text-align:center;line-height: 2em;">
promoter,gene,UTR5,CDS,exon,intron,UTR3
</td>
<td style="text-align:center;line-height: 2em;">
HdF041849(p),HdF041849(g)
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
15001
</td>
<td style="text-align:center;line-height: 2em;">
25000
</td>
<td style="text-align:center;line-height: 2em;">
7
</td>
<td style="text-align:center;line-height: 2em;">
0.0436644
</td>
<td style="text-align:center;line-height: 2em;">
0.0239114
</td>
<td style="text-align:center;line-height: 2em;">
promoter,gene,UTR5,exon,intron
</td>
<td style="text-align:center;line-height: 2em;">
HdF041849(p),HdF041849(g)
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
25001
</td>
<td style="text-align:center;line-height: 2em;">
35000
</td>
<td style="text-align:center;line-height: 2em;">
4
</td>
<td style="text-align:center;line-height: 2em;">
0.0150391
</td>
<td style="text-align:center;line-height: 2em;">
0.0161973
</td>
<td style="text-align:center;line-height: 2em;">
intergenic
</td>
<td style="text-align:center;line-height: 2em;">
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
30001
</td>
<td style="text-align:center;line-height: 2em;">
40000
</td>
<td style="text-align:center;line-height: 2em;">
4
</td>
<td style="text-align:center;line-height: 2em;">
0.0150391
</td>
<td style="text-align:center;line-height: 2em;">
0.0161973
</td>
<td style="text-align:center;line-height: 2em;">
intergenic
</td>
<td style="text-align:center;line-height: 2em;">
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr11
</td>
<td style="text-align:center;line-height: 2em;">
55001
</td>
<td style="text-align:center;line-height: 2em;">
65000
</td>
<td style="text-align:center;line-height: 2em;">
1
</td>
<td style="text-align:center;line-height: 2em;">
-0.0044487
</td>
<td style="text-align:center;line-height: 2em;">
-0.0044487
</td>
<td style="text-align:center;line-height: 2em;">
intergenic
</td>
<td style="text-align:center;line-height: 2em;">
</td>
</tr>
<tr>
<td style="text-align:center;">
chr11
</td>
<td style="text-align:center;">
60001
</td>
<td style="text-align:center;">
70000
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
-0.0044487
</td>
<td style="text-align:center;">
-0.0044487
</td>
<td style="text-align:center;">
intergenic
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="annotate-dmr-slide-windows-with-genomic-features">Annotate DMR slide windows with genomic features<a class="anchor" aria-label="anchor" href="#annotate-dmr-slide-windows-with-genomic-features"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Annotate DMR</span></span>
<span><span class="va">dmr_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="st">"example.dmr"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"GAnnoViz"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">dmr_table</span>,</span>
<span>  header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>  na.strings <span class="op">=</span> <span class="st">"NA"</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># head(dmr)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dmr</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. DMR results from MethylKit"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. DMR results from MethylKit
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
chr
</th>
<th style="text-align:center;font-weight: bold;">
start
</th>
<th style="text-align:center;font-weight: bold;">
end
</th>
<th style="text-align:center;font-weight: bold;">
strand
</th>
<th style="text-align:center;font-weight: bold;">
pvalue
</th>
<th style="text-align:center;font-weight: bold;">
qvalue
</th>
<th style="text-align:center;font-weight: bold;">
meth.diff
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
466001
</td>
<td style="text-align:center;line-height: 2em;">
468000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0041571
</td>
<td style="text-align:center;line-height: 2em;">
0.0120671
</td>
<td style="text-align:center;line-height: 2em;">
-27.31707
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
660001
</td>
<td style="text-align:center;line-height: 2em;">
662000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
-33.37925
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
1454001
</td>
<td style="text-align:center;line-height: 2em;">
1456000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
-26.55631
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
2750001
</td>
<td style="text-align:center;line-height: 2em;">
2752000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
25.04745
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
3428001
</td>
<td style="text-align:center;line-height: 2em;">
3430000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
-46.33124
</td>
</tr>
<tr>
<td style="text-align:center;">
chr1
</td>
<td style="text-align:center;">
3604001
</td>
<td style="text-align:center;">
3606000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
37.85743
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anno_fst_dmr.html">anno_fst_dmr</a></span><span class="op">(</span></span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  genomic_ranges <span class="op">=</span> <span class="va">dmr_table</span>,</span>
<span>  chrom_col <span class="op">=</span> <span class="st">"chr"</span>,</span>
<span>  start_col <span class="op">=</span> <span class="st">"start"</span>,</span>
<span>  end_col <span class="op">=</span> <span class="st">"end"</span>,</span>
<span>  upstream <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  downstream <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  ignore_strand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"promoter"</span>, <span class="st">"UTR5"</span>, <span class="st">"gene"</span>, <span class="st">"exon"</span>, <span class="st">"intron"</span>, <span class="st">"CDS"</span>, <span class="st">"UTR3"</span>, <span class="st">"intergenic"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># head(res)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kbl</span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"Table. DMR annotation results"</span>, </span>
<span>    escape <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    align <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kable_classic</span><span class="op">(</span></span>
<span>    <span class="st">"striped"</span>, </span>
<span>    full_width <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    html_font <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">0</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">row_spec</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, extra_css <span class="op">=</span> <span class="st">"line-height: 2em;"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic lightable-striped" style="font-family: Times; margin-left: auto; margin-right: auto;">
<caption>
Table. DMR annotation results
</caption>
<thead><tr>
<th style="text-align:center;font-weight: bold;">
chr
</th>
<th style="text-align:center;font-weight: bold;">
start
</th>
<th style="text-align:center;font-weight: bold;">
end
</th>
<th style="text-align:center;font-weight: bold;">
strand
</th>
<th style="text-align:center;font-weight: bold;">
pvalue
</th>
<th style="text-align:center;font-weight: bold;">
qvalue
</th>
<th style="text-align:center;font-weight: bold;">
meth.diff
</th>
<th style="text-align:center;font-weight: bold;">
anno_type
</th>
<th style="text-align:center;font-weight: bold;">
gene_id
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
466001
</td>
<td style="text-align:center;line-height: 2em;">
468000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0041571
</td>
<td style="text-align:center;line-height: 2em;">
0.0120671
</td>
<td style="text-align:center;line-height: 2em;">
-27.31707
</td>
<td style="text-align:center;line-height: 2em;">
gene,intron
</td>
<td style="text-align:center;line-height: 2em;">
HdF051575(g)
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
660001
</td>
<td style="text-align:center;line-height: 2em;">
662000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
-33.37925
</td>
<td style="text-align:center;line-height: 2em;">
gene,intron
</td>
<td style="text-align:center;line-height: 2em;">
HdF051575(g)
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
1454001
</td>
<td style="text-align:center;line-height: 2em;">
1456000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
-26.55631
</td>
<td style="text-align:center;line-height: 2em;">
gene,exon,UTR3
</td>
<td style="text-align:center;line-height: 2em;">
HdF027216(g)
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
2750001
</td>
<td style="text-align:center;line-height: 2em;">
2752000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
25.04745
</td>
<td style="text-align:center;line-height: 2em;">
intergenic
</td>
<td style="text-align:center;line-height: 2em;">
</td>
</tr>
<tr>
<td style="text-align:center;line-height: 2em;">
chr1
</td>
<td style="text-align:center;line-height: 2em;">
3428001
</td>
<td style="text-align:center;line-height: 2em;">
3430000
</td>
<td style="text-align:center;line-height: 2em;">
<ul><li></ul>
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
0.0000000
</td>
<td style="text-align:center;line-height: 2em;">
-46.33124
</td>
<td style="text-align:center;line-height: 2em;">
gene,intron
</td>
<td style="text-align:center;line-height: 2em;">
HdF027234(g)
</td>
</tr>
<tr>
<td style="text-align:center;">
chr1
</td>
<td style="text-align:center;">
3604001
</td>
<td style="text-align:center;">
3606000
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
37.85743
</td>
<td style="text-align:center;">
gene,intron
</td>
<td style="text-align:center;">
HdF027242(g)
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="plot-snp-density-at-chromosome-level">Plot SNP density at chromosome level<a class="anchor" aria-label="anchor" href="#plot-snp-density-at-chromosome-level"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot SNP density</span></span>
<span><span class="fu"><a href="../reference/plot_snp_density.html">plot_snp_density</a></span><span class="op">(</span></span>
<span>  fst_file <span class="op">=</span> <span class="va">fst_table</span>,</span>
<span>  LOG10 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bin_size <span class="op">=</span> <span class="fl">1e6</span>,</span>
<span>  density_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0088ff"</span>, <span class="st">"#ff8800"</span>, <span class="st">"#ff0000"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_snp_density-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-genomic-weighted-fst-heatmap">Plot genomic weighted FST heatmap<a class="anchor" aria-label="anchor" href="#plot-genomic-weighted-fst-heatmap"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot weighted FST</span></span>
<span><span class="fu"><a href="../reference/plot_snp_fst.html">plot_snp_fst</a></span><span class="op">(</span></span>
<span>  fst_file <span class="op">=</span> <span class="va">fst_table</span>,</span>
<span>  bin_size <span class="op">=</span> <span class="fl">1e6</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"fst_mean"</span>,</span>
<span>  orientation <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffffff"</span>, <span class="st">"#aa00aa"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_snp_fst-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-genomic-fst-with-top-n-gene-annotations">Plot genomic FST with Top-N gene annotations<a class="anchor" aria-label="anchor" href="#plot-genomic-fst-with-top-n-gene-annotations"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chromosome FST with Top-20 gene annotations on chr11</span></span>
<span><span class="fu"><a href="../reference/plot_snp_anno.html">plot_snp_anno</a></span><span class="op">(</span></span>
<span>  fst_file <span class="op">=</span> <span class="va">fst_table</span>,</span>
<span>  gff_file <span class="op">=</span> <span class="va">gff_file</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  chrom_id <span class="op">=</span> <span class="st">"chr2"</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  orientation <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>  smooth_span <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  fst_color <span class="op">=</span> <span class="st">"#0088ff"</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  point_alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  connector_dx1 <span class="op">=</span> <span class="fl">2e4</span>,</span>
<span>  connector_dx2 <span class="op">=</span> <span class="fl">4e4</span>,</span>
<span>  gap_frac <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_snp_anno-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="dmg-anno-plot">8. DMG Anno &amp; Plot<a class="anchor" aria-label="anchor" href="#dmg-anno-plot"></a>
</h3>
<div class="section level4">
<h4 id="plot-differentially-methylated-regions-dmrs-hyperhypo-distributions-by-chromosome">Plot differentially methylated regions (DMRs) hyper/hypo
distributions by chromosome<a class="anchor" aria-label="anchor" href="#plot-differentially-methylated-regions-dmrs-hyperhypo-distributions-by-chromosome"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot chrom DMRs</span></span>
<span><span class="fu"><a href="../reference/plot_dmg_chrom.html">plot_dmg_chrom</a></span><span class="op">(</span></span>
<span>  dmr_file <span class="op">=</span> <span class="va">dmr_table</span>,</span>
<span>  violin_scale <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>  violin_border <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  point_shape <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  jitter_width <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  hyper_color <span class="op">=</span> <span class="st">"#ff880088"</span>,</span>
<span>  hypo_color <span class="op">=</span> <span class="st">"#0088ff88"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_chrom_dmr-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="plot-chromosomal-dmgs-trend">Plot chromosomal DMGs trend<a class="anchor" aria-label="anchor" href="#plot-chromosomal-dmgs-trend"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot DMR trend</span></span>
<span><span class="fu"><a href="../reference/plot_dmg_trend.html">plot_dmg_trend</a></span><span class="op">(</span></span>
<span>  chrom_id <span class="op">=</span> <span class="st">"chr1"</span>,</span>
<span>  dmr_file <span class="op">=</span> <span class="va">dmr_table</span>,</span>
<span>  smooth_span <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  hyper_color <span class="op">=</span> <span class="st">"#ff0000"</span>,</span>
<span>  hypo_color <span class="op">=</span> <span class="st">"#008800"</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  point_alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot_dmg_trend-1.png" class="r-plt" width="1200" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benben Miao.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
